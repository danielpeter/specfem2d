<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>SPECFEM2D</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=00e904481ff628568d9bf52b093849a8243c2d86">
  </head>
  <body>
    <section class="page-header">
      <div class="parallax"><!-- parallax -->
        <div class="parallax_layer parallax_layer_back">
          <div class="img_background img1"></div>
        </div>
      <!-- </div> -->
      <div class="parallax_layer parallax_layer_front">
        <h1 class="project-name">SPECFEM2D</h1>
        <h2 class="project-tagline">SPECFEM2D allows users to perform 2D and 2.5D (i.e., axisymmetric) simulations of acoustic, elastic, viscoelastic, and poroelastic seismic wave propagation. 
</h2>
        
          <a href="http://github.com/danielpeter/specfem2d" class="btn">View on GitHub</a>
        
        
      </div><!-- end of parallax -->
    </section>

    <section class="main-content">
      <p><strong>Table of Contents</strong></p>

<ul>
  <li><a href="#running-the-solver-xspecfem2d">Running the Solver xspecfem2D</a>
    <ul>
      <li><a href="#notes-about-datapar_file-parameters">Notes about <code class="highlighter-rouge">DATA/Par_file</code> parameters</a></li>
      <li><a href="#notes-about-datasource-parameters">Notes about <code class="highlighter-rouge">DATA/SOURCE</code> parameters</a></li>
      <li><a href="#how-to-run-elastic-wave-simulations">How to run elastic wave simulations</a></li>
      <li><a href="#how-to-run-axisymmetric-wave-simulations">How to run axisymmetric wave simulations</a></li>
      <li><a href="#how-to-run-anisotropic-wave-simulations">How to run anisotropic wave simulations</a></li>
      <li><a href="#how-to-run-poroelastic-wave-simulations">How to run poroelastic wave simulations</a></li>
      <li><a href="#coupled-simulations">Coupled simulations</a></li>
      <li><a href="#how-to-choose-the-time-step">How to choose the time step</a></li>
      <li><a href="#how-to-set-plane-waves-as-initial-conditions">How to set plane waves as initial conditions</a></li>
      <li><a href="#note-on-the-viscoelastic-model-used">Note on the viscoelastic model used</a></li>
      <li><a href="#note-on-viscoelasticity-in-the-2d-plane-strain-approximation">Note on viscoelasticity in the 2D plane strain approximation</a></li>
    </ul>
  </li>
</ul>

<h1 id="running-the-solver-xspecfem2d">Running the Solver xspecfem2D</h1>

<p>To run the solver, type</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    bin/xspecfem2D
</code></pre>
</div>

<p>from within the main working directory (use <code class="highlighter-rouge">mpirun</code> or equivalent if you compiled with parallel support). This will output the seismograms and snapshots of the wave fronts at different time steps in directory <code class="highlighter-rouge">OUTPUT_FILES/</code>. To visualize them, type “<code class="highlighter-rouge">gs OUTPUT_FILES/vect*.ps</code>” to see the Postscript files (in which the wave field is represented with small arrows, fluid/solid matching interfaces with a thick pink line, and absorbing edges with a thick green line) and “<code class="highlighter-rouge">gimp OUTPUT_FILES/image*.gif</code>” to see the colour snapshot showing a pixelized image of one of the two components of the wave field (or pressure, depending on what you have selected for the output in <code class="highlighter-rouge">DATA/Par_file</code>).</p>

<p><img src="figures/image0000300.jpg" alt="Wavefield snapshots of the default example generated by `xspecfem2D` when parameter `output_color_image` is set to `.true.`. To create smaller (subsampled) images you can change double precision parameter `factor_subsample_image = 1.0` to a higher value in file `DATA/Par_file`. This can be useful in the case of very large models. The number of pixels of the image in each direction must be smaller than parameter `NX_NZ_IMAGE_MAX` defined in file `SETUP/constants.h.in`, again to avoid creating huge images in the case of very large models.&lt;span data-label=&quot;fig:example.solver&quot;&gt;&lt;/span&gt;" title="fig:" /> &lt;div class="figcaption" style="text-align:justify;font-size:80%"&gt;<span style="color:#9A9A9A">Figure: Wavefield snapshots of the default example generated by <code class="highlighter-rouge">xspecfem2D</code> when parameter <code class="highlighter-rouge">output_color_image</code> is set to <code class="highlighter-rouge">.true.</code>. To create smaller (subsampled) images you can change double precision parameter <code class="highlighter-rouge">factor_subsample_image = 1.0</code> to a higher value in file <code class="highlighter-rouge">DATA/Par_file</code>. This can be useful in the case of very large models. The number of pixels of the image in each direction must be smaller than parameter <code class="highlighter-rouge">NX_NZ_IMAGE_MAX</code> defined in file <code class="highlighter-rouge">SETUP/constants.h.in</code>, again to avoid creating huge images in the case of very large models.<span data-label="fig:example.solver"></span></span>&lt;/div&gt; <img src="figures/image0000400.jpg" alt="Wavefield snapshots of the default example generated by `xspecfem2D` when parameter `output_color_image` is set to `.true.`. To create smaller (subsampled) images you can change double precision parameter `factor_subsample_image = 1.0` to a higher value in file `DATA/Par_file`. This can be useful in the case of very large models. The number of pixels of the image in each direction must be smaller than parameter `NX_NZ_IMAGE_MAX` defined in file `SETUP/constants.h.in`, again to avoid creating huge images in the case of very large models.&lt;span data-label=&quot;fig:example.solver&quot;&gt;&lt;/span&gt;" title="fig:" /> &lt;div class="figcaption" style="text-align:justify;font-size:80%"&gt;<span style="color:#9A9A9A">Figure: Wavefield snapshots of the default example generated by <code class="highlighter-rouge">xspecfem2D</code> when parameter <code class="highlighter-rouge">output_color_image</code> is set to <code class="highlighter-rouge">.true.</code>. To create smaller (subsampled) images you can change double precision parameter <code class="highlighter-rouge">factor_subsample_image = 1.0</code> to a higher value in file <code class="highlighter-rouge">DATA/Par_file</code>. This can be useful in the case of very large models. The number of pixels of the image in each direction must be smaller than parameter <code class="highlighter-rouge">NX_NZ_IMAGE_MAX</code> defined in file <code class="highlighter-rouge">SETUP/constants.h.in</code>, again to avoid creating huge images in the case of very large models.<span data-label="fig:example.solver"></span></span>&lt;/div&gt; <img src="figures/image0000500.jpg" alt="Wavefield snapshots of the default example generated by `xspecfem2D` when parameter `output_color_image` is set to `.true.`. To create smaller (subsampled) images you can change double precision parameter `factor_subsample_image = 1.0` to a higher value in file `DATA/Par_file`. This can be useful in the case of very large models. The number of pixels of the image in each direction must be smaller than parameter `NX_NZ_IMAGE_MAX` defined in file `SETUP/constants.h.in`, again to avoid creating huge images in the case of very large models.&lt;span data-label=&quot;fig:example.solver&quot;&gt;&lt;/span&gt;" title="fig:" /></p>
<div class="figcaption" style="text-align:justify;font-size:80%"><span style="color:#9A9A9A">Figure: Wavefield snapshots of the default example generated by `xspecfem2D` when parameter `output_color_image` is set to `.true.`. To create smaller (subsampled) images you can change double precision parameter `factor_subsample_image = 1.0` to a higher value in file `DATA/Par_file`. This can be useful in the case of very large models. The number of pixels of the image in each direction must be smaller than parameter `NX_NZ_IMAGE_MAX` defined in file `SETUP/constants.h.in`, again to avoid creating huge images in the case of very large models.<span data-label="fig:example.solver"></span></span></div>

<p>Please consider these following points, when running the solver:</p>

<ul>
  <li>
    <p>the <code class="highlighter-rouge">DATA/Par_file</code> given with the code works fine, you can use it without any modification to test the code</p>
  </li>
  <li>
    <p>the seismograms <code class="highlighter-rouge">OUTPUT_FILES/*.sem*</code> are simple ASCII files with two columns: time in the first column and amplitude in the second, therefore they can be visualized with any tool you like, for instance “<code class="highlighter-rouge">gnuplot</code>”; if you prefer to output binary seismograms in Seismic Unix format (which is a simple binary array dump) you can use parameter <code class="highlighter-rouge">SU_FORMAT</code>, in which case all the seismograms will be written to a single file with the extension <code class="highlighter-rouge">*.bin</code>. Depending on your installation of the Seismic Unix package you can use one of these two commands:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>    surange &lt; Uz_file_single.bin
    suoldtonew &lt; Uz_file_single.bin | surange
</code></pre>
    </div>

    <p>to see the header info. Replace <code class="highlighter-rouge">surange</code> with <code class="highlighter-rouge">suxwigb</code> to see wiggle plots for the seismograms.</p>
  </li>
  <li>
    <p>if flag <code class="highlighter-rouge">MODEL</code> in <code class="highlighter-rouge">DATA/Par_file</code> is set to <code class="highlighter-rouge">default</code>, the velocity and density model is determined using the <code class="highlighter-rouge">nbmodels</code> and <code class="highlighter-rouge">nbregions</code> devices. Otherwise, <code class="highlighter-rouge">nbmodels</code> values are ignored and the velocity and density model is determined from a user supplied file or subroutine.</p>
  </li>
  <li>
    <p>when compiling with Intel ifort, use “<code class="highlighter-rouge">-assume byterecl</code>” option to create binary PNM images displaying the wave field</p>
  </li>
  <li>
    <p>there are a few useful scripts and Fortran routines in directory <code class="highlighter-rouge">utils/</code>.</p>
  </li>
  <li>
    <p>you can find a Fortran code to compute the analytical solution for simple media that we use as a reference in benchmarks in many of our articles at . That code is described in: Berg et al. (1994)</p>
  </li>
</ul>

<h2 id="notes-about-datapar_file-parameters">Notes about <code class="highlighter-rouge">DATA/Par_file</code> parameters</h2>

<p><strong><em>The default <code class="highlighter-rouge">DATA/Par_file</code> provided in the root directory of the code contains detailed comments and should be almost self-explanatory (note that some of the older <code class="highlighter-rouge">DATA/Par_file</code> files provided in the <code class="highlighter-rouge">EXAMPLES</code> directory work fine but some of the comments they contain may be obsolete or even wrong; thus refer to the default <code class="highlighter-rouge">DATA/Par_file</code> instead for reliable explanations).</em></strong></p>

<p>USE_TRICK_FOR_BETTER_PRESSURE<br />
This option can only be used so far if all the receivers record pressure and are in acoustic elements. Use a trick to increase accuracy of pressure seismograms in fluid (acoustic) elements: use the second derivative of the source for the source time function instead of the source itself, and then record <code class="highlighter-rouge">potential_acoustic()</code> as pressure seismograms instead of <code class="highlighter-rouge">potential_dot_dot_acoustic()</code>; this is mathematically equivalent, but numerically significantly more accurate because in the explicit Newmark time scheme acceleration is accurate at zeroth order while displacement is accurate at second order, thus in fluid elements <code class="highlighter-rouge">potential_dot_dot_acoustic()</code> is accurate at zeroth order while <code class="highlighter-rouge">potential_acoustic()</code> is accurate at second order and thus contains significantly less numerical noise.</p>

<p>READ_VELOCITIES_AT_f0<br />
shift (i.e. change) velocities read from the input file to take average physical dispersion into account, i.e. if needed change the reference frequency at which these velocities are defined internally in the code: by default, the velocity values that are read at the end of this Par_file of the code are supposed to be the unrelaxed values, i.e. the velocities at infinite frequency. If you set this flage to .true., the values read are then those for a given frequency called ATTENUATION_f0_REFERENCE.</p>

<p>nbmodels<br />
With <code class="highlighter-rouge">MODEL = default</code> chosen, a variety of simple velocity and density models can be defined using the <code class="highlighter-rouge">nbmodels</code> device.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>I:  model_number 1 rho Vp Vs 0 0 QKappa Qmu 0 0 0 0 0 0
II:  model_number 2 rho c11 c13 c15 c33 c35 c55 c12 c23 c25 0 0 0
III: model_number 3 rhos rhof phi c kxx kxz kzz Ks Kf Kfr etaf mufr Qmu
IV: model_number -1 0 0 A 0 0 0 0 0 0 0 0 0 0
</code></pre>
</div>

<p>To make a given region acoustic, use I and make <code class="highlighter-rouge">Vs</code> be zero.</p>

<p>To make a given region isotropic elastic, use I and make <code class="highlighter-rouge">Vs</code> be nonzero. See Section 4.1 for more details.</p>

<p>To make a given region anisotropic, use II. See Section 4.2 for more details.</p>

<p>To make a given region poroeslatic, use III. See Section 4.3 for more details.</p>

<p>When viscoelasticity is turned on, the <code class="highlighter-rouge">Vp</code> and <code class="highlighter-rouge">Vs</code> values that are read here are the UNRELAXED ones i.e. the values at infinite frequency unless the READ_VELOCITIES_AT_f0 parameter above is set to true, in which case they are the values at frequency (f_0). Please also note that Qmu is always equal to Qs, but Qkappa is in general not equal to Qp. To convert one to the other see doc/note_on_Qkappa_versus_Qp.pdf and utils/attenuation/conversion_from_Qkappa_Qmu_to_Qp_Qs_from_Dahlen_Tromp_959_960.f90.</p>

<p>nbregions<br />
With <code class="highlighter-rouge">MODEL = default</code> chosen, a variety of simple layered model configurations can be specified using the <code class="highlighter-rouge">nbregions</code> device.</p>

<p>Regarding attenuation (viscoelasticity), in the Par_file you need to select the number of standard linear solids (N_SLS) to use to mimic a constant (Q) quality factor. Using N_SLS = 3 is always safe. If (and only if) you know what you are doing, you can try to reduce that in order to reduce the cost of the simulations. Figure [fig:selectNSLS] shows values that you can consider using (again, if and only if you know what you are doing). That table has been created by Zhinan Xie using a comparison between results obtained with a truly-constant (Q) and results obtained with its approximation based on N_SLS standard linear solids. The comparison is performed using the time-frequency misfit and goodness-of-fit criteria proposed by Kristeková, Kristek, and Moczo (2009). The table is drawn for a dimensionless parameter representing the distance of propagation.</p>

<p><img src="figures/minimum_number_of_SLS_that_can_be_used_in_viscoelastic_simulation.png" alt="Table showing how you can select a value of N_SLS smaller than 3, if and only if you know what you are doing.&lt;span data-label=&quot;fig:selectNSLS&quot;&gt;&lt;/span&gt;" /></p>
<div class="figcaption" style="text-align:justify;font-size:80%"><span style="color:#9A9A9A">Figure: Table showing how you can select a value of N\_SLS smaller than 3, if and only if you know what you are doing.<span data-label="fig:selectNSLS"></span></span></div>

<h2 id="notes-about-datasource-parameters">Notes about <code class="highlighter-rouge">DATA/SOURCE</code> parameters</h2>

<p>The <code class="highlighter-rouge">SOURCE</code> file located in the <code class="highlighter-rouge">DATA/</code> directory should be edited in the following way:</p>

<p>source_surf<br />
Set this flag to <code class="highlighter-rouge">.true.</code> to force the source to be located at the surface of the model, otherwise the sol be placed inside the medium</p>

<p>xs<br />
source location (x) in meters</p>

<p>zs<br />
source location (z) in meters</p>

<p>source_type<br />
Set this value equal to <code class="highlighter-rouge">1</code> for elastic forces or acoustic pressure, set this to <code class="highlighter-rouge">2</code> for moment tensor sources. For a plane wave including converted and reflected waves at the free surface, P wave = 1, S wave = 2, Rayleigh wave = 3; for a plane wave without converted nor reflected waves at the free surface, i.e. the incident wave only, P wave = 4, S wave = 5. (incident plane waves are turned on by parameter <code class="highlighter-rouge">initialfield</code> in <code class="highlighter-rouge">DATA/Par_file</code>).</p>

<p>time_function_type<br />
Choose a source-time function: set this value to <code class="highlighter-rouge">1</code> to use a Ricker, i.e. the second derivative of a Gaussian, <code class="highlighter-rouge">2</code> to use the first derivative of a Gaussian, <code class="highlighter-rouge">3</code> to use a Gaussian, <code class="highlighter-rouge">4</code> to use a Dirac or <code class="highlighter-rouge">5</code> to use a Heaviside source-time function. Note that we use the standard definition of a Ricker, for a dominant frequency (f_0): (\mathrm{Ricker}(t) = (1 - 2 a t^2) e^{-a t^2}), with (a = \pi^2 f_0^2), whose Fourier transform is thus: (\frac{1}{2} \frac{\sqrt{\pi}\omega^2}{a^{3/2}}e^{-\frac{\omega^2}{4 a}}) This gives the wavelet of Figure [fig:RickerWavelet].</p>

<p><img src="figures/Ricker_wavelet.png" alt="We use the standard definition of a Ricker (i.e., second derivative of a Gaussian). Image taken from &lt;http://subsurfwiki.org&gt;.&lt;span data-label=&quot;fig:RickerWavelet&quot;&gt;&lt;/span&gt;" /></p>
<div class="figcaption" style="text-align:justify;font-size:80%"><span style="color:#9A9A9A">Figure: We use the standard definition of a Ricker (i.e., second derivative of a Gaussian). Image taken from &lt;http://subsurfwiki.org&gt;.<span data-label="fig:RickerWavelet"></span></span></div>

<p>f0<br />
Set this to the dominant frequency of the source. For point-source simulations using a Heaviside source-time function (<code class="highlighter-rouge">time_function_type = 5</code>), we recommend setting the source frequency parameter <code class="highlighter-rouge">f0</code> equal to a high value, which corresponds to simulating a step source-time function, i.e., a moment-rate function that is a delta function.</p>

<p>The <code class="highlighter-rouge">half duration</code> of a source is obtained by (1/\mathtt{f0}). If the code will use a Gaussian source-time function (<code class="highlighter-rouge">time_function_type = 3</code>) (i.e., a signal with a shape similar to a ‘smoothed triangle’, as explained in Komatitsch and Tromp (2002) and shown in Fig [fig:gauss.vs.triangle]), the source-time function uses a half-width of <code class="highlighter-rouge">half duration</code>. We prefer to run the solver with <code class="highlighter-rouge">half duration</code> set to zero and convolve the resulting synthetic seismograms in post-processing after the run, because this way it is easy to use a variety of source-time functions. Komatitsch and Tromp (2002) determined that the noise generated in the simulation by using a step source time function may be safely filtered out afterward based upon a convolution with the desired source time function and/or low-pass filtering. Use the serial code <code class="highlighter-rouge">convolve_source_timefunction.f90</code> and the script <code class="highlighter-rouge">convolve_source_timefunction.sh</code> for this purpose, or alternatively use signal-processing software packages such as SAC . Type</p>

<div class="highlighter-rouge"><pre class="highlight"><code>    make xconvolve_source_timefunction
</code></pre>
</div>

<p>to compile the code and then set the parameter <code class="highlighter-rouge">hdur</code> in <code class="highlighter-rouge">convolve_source_timefunction.sh</code> to the desired half-duration.</p>

<p><img src="figures/gauss_vs_triangle_mod.pdf" alt="Comparison of the shape of a triangle and the Gaussian function actually used.&lt;span data-label=&quot;fig:gauss.vs.triangle&quot;&gt;&lt;/span&gt;" /></p>
<div class="figcaption" style="text-align:justify;font-size:80%"><span style="color:#9A9A9A">Figure: Comparison of the shape of a triangle and the Gaussian function actually used.<span data-label="fig:gauss.vs.triangle"></span></span></div>

<p>t0<br />
For single sources, we recommend to set the time shift parameter <code class="highlighter-rouge">t0</code> equal to (0.0). The time shift parameter would simply apply an overall time shift to the synthetics (according to the time shift of the first source), something that can be done in the post-processing. This time shift parameter can be non-zero when using multiple sources.</p>

<p>anglesource<br />
angle of the source (for a force only); for a plane wave, this is the incidence angle. For moment tensor sources this parameter is unused.</p>

<p>Mxx,Mzz,Mxz<br />
Moment tensor components (valid only for moment tensor sources, <code class="highlighter-rouge">source_type = 2</code>). Note that the units for the components of a moment tensor source are different in SPECFEM2D and in SPECFEM3D:</p>

<p>SPECFEM3D:<br />
in SPECFEM3D the moment tensor components are in dyne*cm</p>

<p>SPECFEM2D:<br />
in SPECFEM2D the moment tensor components are in N*m</p>

<p>To go from strike / dip / slip to CMTSOLUTION moment-tensor format using the classical formulas (of e.g. Aki and Richards (1980) you can use these two small C programs from <code class="highlighter-rouge">SPECFEM3D_GLOBE</code>:</p>

<p><code class="highlighter-rouge">./utils/strike_dip_rake_to_CMTSOLUTION.c</code></p>

<p><code class="highlighter-rouge">./utils/CMTSOLUTION_to_AkiRichards.c</code></p>

<p>but then it is another story to make a good 2D approximation of that, because in plain-strain P-SV what you get is the equivalent of a line source in the third direction (orthogonal to the plane) rather than a 3D point source For more details on this see e.g. Section 7.3 “Two-dimensional point sources” of the book of Pilant (1979). That book being hard to find, we scanned the related pages in file
<code class="highlighter-rouge">discussion_of_2D_sources_and_approximations_from_Pilant_1979.pdf</code> in the same directory as this users manual. Another very useful reference addressing that is Helmberger and Vidale (1988) and its recent extension (Li et al. 2014).</p>

<p>factor<br />
amplification factor</p>

<p>Note, the zero time of the simulation corresponds to the center of the triangle/Gaussian, or the centroid time of the earthquake. The start time of the simulation is (t=-1.2*\mathtt{half duration} + \mathtt{t0}) (the factor 1.2 is to make sure the moment rate function is very close to zero when starting the simulation; Heaviside functions use a factor 2.0), the half duration is obtained by (1/\mathtt{f0}). If you prefer, you can fix this start time by setting the parameter <code class="highlighter-rouge">USER_T0</code> in the <code class="highlighter-rouge">constants.h</code> file to a positive, non-zero value. The simulation in that case would start at a starting time equal to <code class="highlighter-rouge">-USER_T0</code>.</p>

<h2 id="how-to-run-elastic-wave-simulations">How to run elastic wave simulations</h2>

<p>For isotropic elastic materials, there are two options:</p>

<p>P-SV:<br />
To run a P-SV waves calculation propagating in the (x)-(z) plane, set <code class="highlighter-rouge">p_sv = .true.</code> in the <code class="highlighter-rouge">Par_file</code>.</p>

<p>SH:<br />
To run a SH (membrane) waves calculation travelling in the (x)-(z) plane with a (y)-component of motion, set <code class="highlighter-rouge">p_sv = .false.</code></p>

<p>This feature is only implemented for elastic materials and sensitivity kernels can be calculated (see Tape, Liu, and Tromp (2007) for details on membrane surface waves).</p>

<p>An optional useful Python script called <code class="highlighter-rouge">SEM_save_dir.py</code> is provided. It allows one to automatically save all the parameters and results of a given simulation.</p>

<h2 id="how-to-run-axisymmetric-wave-simulations">How to run axisymmetric wave simulations</h2>

<p>Axisymmetric simulations are possible in SPECFEM2D. For these simulations the 2D domain simulated is physically the meridional 2D shape of an axisymmetric 3D domain. We invite you to read our publication (Bottero et al. 2016) as an introduction. To set the geometry as axisymmetric turn the flag <code class="highlighter-rouge">AXISYM</code> to <code class="highlighter-rouge">.true.</code> in the <code class="highlighter-rouge">Par_file</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>   AXISYM                          = .true.
</code></pre>
</div>

<p>The left border of the model becomes then a symmetry axis. The wavefield calculated is then physically a 3D wavefield obtained by revolution of a 2D wavefield around its left border.
Note about the source:
In axisymmetric geometry the whole model is symmetric with respect to this axis, including the source. Hence if the source is not on the axis it will physically have a circular shape. This is still possible and relevant for some applications as non destructive testing but is most of the time unwanted. This has to be kept in mind. In acoustic medium, as an explosion in a fluid is naturally axisymmetric, the wavefield generated has the correct 3D shape. However, if the source is put in an elastic solid, its 3D radiation pattern will be axisymmetric.
Getting started:
To get started a simple example is available in <code class="highlighter-rouge">EXAMPLES/axisymmetric_case_AXISYM_option</code>, we encourage you to read the <code class="highlighter-rouge">README</code> file you will find there. This example contains an example of the use of <code class="highlighter-rouge">AXISYM</code> option plus a validation using the semi-analytical code OASES (Schmidt (2004)). In this example the domain studied is a water layer lying above a viscoelastic medium. The source is an explosion in the water and the domain is bounded with PMLs.
Note about external meshers:
Using external meshers is possible in axisymmetric geometry. An example is available in
<code class="highlighter-rouge">EXAMPLES/paper_axisymmetry_example</code> with the mesher Cubit/Trelis (<a href="http://www.csimsoft.com/trelis">http://www.csimsoft.com/trelis</a>). We invite you to check this example and read the previous chapter for more details. The only difference with plane-strain geometry is that SPECFEM2D needs an additional file defining axial elements. The path to this file has to be given in the <code class="highlighter-rouge">Par_file</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>   axial_elements_file             = /path/to/the/axial_elements_file
</code></pre>
</div>

<p>The axial elements file has the following structure:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>        48
         1          2       8456       8457
         2          2       8457       8458
         3          2       8458       8459
         4          2       8459       8460
       623          2        171        204
      1053          2        172       9512
      1054          2        172        173
      1055          2        173        174
      ...
</code></pre>
</div>

<p>Which is similar to free surface files. Hence the first line contains the number of axial elements, then the other lines contain four columns: element id, number of nodes describing an axial element (always 2), first node id, second node id. Note that the axis elements must include the possible (up and/or down) PMLs elements in contact with the axis. For simplicity we assume that the mesh elements that are in contact with the symmetry axis are in contact with it by a full edge rather than by a single point, i.e. we exclude cases as that of Figure [fig:meshrestrictionontheaxis]. This amounts to imposing that the leftmost layer of elements in the mesh be structured rather than non structured; The rest of the mesh can be non structured.</p>

<p><img src="figures/meshrestrictionontheaxis-eps-converted-to.pdf" alt="[fig:meshrestrictionontheaxis] For simplicity we exclude cases in which the mesh elements that are in contact with the symmetry axis are in contact with it by a single point instead of by a full edge, such as element (\bar{\Omega}_2) here. This amounts to imposing that the leftmost layer of elements in the mesh be structured rather than non structured; The rest of the mesh can be non structured." /></p>
<div class="figcaption" style="text-align:justify;font-size:80%"><span style="color:#9A9A9A">Figure: [fig:meshrestrictionontheaxis] For simplicity we exclude cases in which the mesh elements that are in contact with the symmetry axis are in contact with it by a single point instead of by a full edge, such as element \(\bar{\Omega}_2\) here. This amounts to imposing that the leftmost layer of elements in the mesh be structured rather than non structured; The rest of the mesh can be non structured.</span></div>

<p>Note about the resolution:
In axisymmetry a different quadrature is used in the axial elements making the number of points per wavelength necessary a slightly bigger ((\approx 25\%)) than in plane-strain.
Note about a small remaining bug:
It has to be noted that a small bug is still hiding somewhere in the code. Indeed the output signals generated are correct in the whole domain except in the element containing the source. This small bug has not been solved so far but not prevent to use the code.
Note about a demo code to learn:
A simplistic demo code is available in
<code class="highlighter-rouge">utils/small_SEM_solver_in_Fortran_without_MPI_to_learn</code>. This simple code is useful to learn how the spectral-element method works in both plane-strain and axisymmetric geometries. Have a look to it if interested. Once in its directory, type <code class="highlighter-rouge">./make_Fortran_2D_axisymmetric.csh</code> and then <code class="highlighter-rouge">./xspecfem2D</code> to compile and run. The bug discussed above is not present in this small code.</p>

<h2 id="how-to-run-anisotropic-wave-simulations">How to run anisotropic wave simulations</h2>

<p>Following J. M. Carcione, Kosloff, and Kosloff (1988a), we use the classical reduced Voigt notation to represent symmetric tensors (Helbig 1994; Carcione 2007):</p>

<blockquote>
  <p>The constitutive relation of a heterogeneous anisotropic and elastic solid is expressed by the generalized Hooke’s law, which can be written as [\sigma_{ij} = c_{ijkl} \varepsilon_{kl}, \qquad i, j, k = 1, \dots, 3,] where (t) is the time, (\mathbf{x}) is the position vector, (\sigma_{ij}(\mathbf{x}, t)) and (\varepsilon_{ij}(\mathbf{x}, t)) are the Cartesian components of the stress and strain tensors respectively, and (c_{ijkl}(\mathbf{x})) are the components of a fourth-order tensor called the elasticites of the medium. The Einstein convention for repeated indices is used.</p>

  <p>To express the stress-strain relation for a transversely isotropic medium we introduce a shortened matrix notation commonly used in the literature. With this convention, pairs of subscripts concerning the elasticities are replaced by a single number according to the following correspondence: [\begin{aligned}
(11) \rightarrow 1, &amp;&amp;
(22) \rightarrow 2, &amp;&amp;
(33) \rightarrow 3, <br />
(23) = (32) \rightarrow 4, &amp;&amp;
(31) = (13) \rightarrow 5, &amp;&amp;
(12) = (21) \rightarrow 6.\end{aligned}]</p>
</blockquote>

<p>Thus in the most general 2D case we have the following convention for the stress-strain relationship:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>! implement anisotropy in 2D
sigma_xx = c11*dux_dx + c13*duz_dz + c15*(duz_dx + dux_dz)
sigma_zz = c13*dux_dx + c33*duz_dz + c35*(duz_dx + dux_dz)
sigma_xz = c15*dux_dx + c35*duz_dz + c55*(duz_dx + dux_dz)

! sigma_yy is not equal to zero in the plane strain formulation
! but is used only in post-processing if needed,
! to compute pressure for display or seismogram recording purposes
sigma_yy = c12*dux_dx + c23*duz_dz + c25*(duz_dx + dux_dz)
</code></pre>
</div>

<p>where the notations are for instance <code class="highlighter-rouge">duz_dx = d(Uz) / dx</code>.</p>

<h2 id="how-to-run-poroelastic-wave-simulations">How to run poroelastic wave simulations</h2>

<p>Check the following new inputs in <code class="highlighter-rouge">Par_file</code>:</p>

<p>In section <strong>“# geometry of model and mesh description”</strong>:<br />
<code class="highlighter-rouge">TURN_VISCATTENUATION_ON</code>, <code class="highlighter-rouge">Q0</code>, and <code class="highlighter-rouge">FREQ0</code> deal with viscous damping in a poroelastic medium. <code class="highlighter-rouge">Q0</code> is the quality factor set at the central frequency <code class="highlighter-rouge">FREQ0</code>. For more details see Morency and Tromp (2008).</p>

<p>In section <strong>“# time step parameters”</strong>:<br />
<code class="highlighter-rouge">SIMULATION_TYPE</code> defines the type of simulation</p>

<ol>
  <li>
    <p>forward simulation</p>
  </li>
  <li>
    <p>UNUSED (purposely, for compatibility with the numbering convention used in our 3D codes)</p>
  </li>
  <li>
    <p>adjoint method and kernels calculation</p>
  </li>
</ol>

<p>In section <strong>“# source parameters”</strong>:<br />
The code now support multiple sources. <code class="highlighter-rouge">NSOURCE</code> is the number of sources. Parameters of the sources are displayed in the file <code class="highlighter-rouge">SOURCE</code>, which must be in the directory <code class="highlighter-rouge">DATA/</code>. The components of a moment tensor source must be given in N.m, not in dyne.cm as in the <code class="highlighter-rouge">DATA/CMTSOLUTION</code> source file of the 3D version of the code.</p>

<p><img src="figures/source_timing.pdf" alt="Example of timing for three sources. The center of the first source triangle is defined to be time zero. Note that this is NOT in general the hypocentral time, or the start time of the source (marked as `tstart`). The time shift parameter `t0` in the `SOURCE` file would be (t1(=0)), (t2), (t3) in this case, and the half-duration parameter, `f0`, would be (\mathtt{hdur1}=1/\mathtt{f0}_1), (\mathtt{hdur2}=1/\mathtt{f0}_2), (\mathtt{hdur3}=1/\mathtt{f0}_3) for the sources 1, 2, 3 respectively.&lt;span data-label=&quot;fig:sourcetiming&quot;&gt;&lt;/span&gt;" /></p>
<div class="figcaption" style="text-align:justify;font-size:80%"><span style="color:#9A9A9A">Figure: Example of timing for three sources. The center of the first source triangle is defined to be time zero. Note that this is NOT in general the hypocentral time, or the start time of the source (marked as `tstart`). The time shift parameter `t0` in the `SOURCE` file would be \(t1(=0)\), \(t2\), \(t3\) in this case, and the half-duration parameter, `f0`, would be \(\mathtt{hdur1}=1/\mathtt{f0}_1\), \(\mathtt{hdur2}=1/\mathtt{f0}_2\), \(\mathtt{hdur3}=1/\mathtt{f0}_3\) for the sources 1, 2, 3 respectively.<span data-label="fig:sourcetiming"></span></span></div>

<p>In section <strong>“# receiver line parameters for seismograms”</strong>:<br />
<code class="highlighter-rouge">SAVE_FORWARD</code> determines if the last frame of a forward simulation is saved (<code class="highlighter-rouge">.true.</code>) or not (<code class="highlighter-rouge">.false</code>)</p>

<p>In section <strong>“# define models….”</strong>:<br />
There are three possible types of models:</p>

<ol>
  <li>
    <p>(<code class="highlighter-rouge">model_number 1 rho Vp Vs 0 0 QKappa Qmu 0 0 0 0 0 0</code>) or</p>
  </li>
  <li>
    <p>(<code class="highlighter-rouge">model_number 2 rho c11 c13 c15 c33 c35 c55 c12 c23 c25 0 0 0</code>) or</p>
  </li>
  <li>
    <p>(<code class="highlighter-rouge">model_number 3 rhos rhof phi c kxx kxz kzz Ks Kf Kfr etaf mufr Qmu</code>).</p>
  </li>
</ol>

<p>For isotropic elastic/acoustic material use <code class="highlighter-rouge">I</code> and set <code class="highlighter-rouge">Vs</code> to zero to make a given model acoustic, for anisotropic elastic use <code class="highlighter-rouge">II</code>, and for isotropic poroelastic material use <code class="highlighter-rouge">III</code>. The mesh can contain acoustic, elastic, and poroelastic models simultaneously.</p>

<p>For anisotropic elastic media the last three parameters, <code class="highlighter-rouge">c12 c23 c25</code>, are used only when the user asks the code to compute pressure for display or seismogram recording purposes. Thus, if you do not know these parameters for your anisotropic material and/or if you do not plan to display or record pressure you can ignore them and set them to zero. When pressure is used these three parameters are needed because the code needs to compute (\sigma_{yy}), which is not equal to zero in the plane strain formulation.</p>

<p>rho_s<br />
= solid density</p>

<p>rho_f<br />
= fluid density</p>

<p>phi<br />
= porosity</p>

<p>tort<br />
= tortuosity</p>

<p>permxx<br />
= xx component of permeability tensor</p>

<p>permxz<br />
= xz,zx components of permeability tensor</p>

<p>permzz<br />
= zz component of permeability tensor</p>

<p>kappa_s<br />
= solid bulk modulus</p>

<p>kappa_f<br />
= fluid bulk modulus</p>

<p>kappa_fr<br />
= frame bulk modulus</p>

<p>eta_f<br />
= fluid viscosity</p>

<p>mu_fr<br />
= frame shear modulus</p>

<p>Qmu<br />
= shear quality factor</p>

<p>Note: for the poroelastic case, <code class="highlighter-rouge">mu_s</code> is irrelevant. For details on the poroelastic theory see Morency and Tromp (2008).</p>

<p><code class="highlighter-rouge">get_poroelastic_velocities.f90</code> allows to compute cpI, cpII, and cs function of the source dominant frequency. Notice that for this calculation we use <code class="highlighter-rouge">permxx</code> and the dominant frequency of the first source, f0(1). Caution if you use several sources with different frequencies and if you consider anistropic permeability.</p>

<h2 id="coupled-simulations">Coupled simulations</h2>

<p>The code supports acoustic/elastic, acoustic/poroelastic, elastic/poroelastic, and acoustic, elastic/poroelastic simulations. Elastic/poroelastic coupling supports anisotropy, but not attenuation for the elastic material.</p>

<h2 id="how-to-choose-the-time-step">How to choose the time step</h2>

<p>Three different explicit conditionally-stable time schemes can be used for elastic, acoustic (fluid) or coupled elastic/acoustic media: the Newmark method, the low-dissipation and low-dispersion fourth-order six-stage Runge-Kutta method (LDDRK4-6) presented in Berland, Bogey, and Bailly (2006), and the classical fourth-order four-stage Runge-Kutta (RK4) method. Currently the last two methods are not implemented for poroelastic media. According to <span>De Basabe</span> and Sen (2010) and Berland, Bogey, and Bailly (2006), with different degrees (N=NGLLX-1) of the GLL basis functions the CFL bounds are given in the following tables. Note that by default the SPECFEM solver uses (NGLLX = 5) and thus a degree (N = 4), which is thus the value you should use in most cases in the following tables. You can directly compare these values with the value given in sentence ‘Max stability for P wave velocity’ in file <code class="highlighter-rouge">output_solver.txt</code> to see whether you set the correct (\Delta t) in <code class="highlighter-rouge">Par_file</code> or not. For elastic simulation, the CFL value given in <code class="highlighter-rouge">output_solver.txt</code> does not consider the (V_p/V_s) ratio, but the CFL limit slight decreases when (V_p/V_s) increases. In viscoelastic simulations the CFL limit does not change compared to the elastic case because we use a rational approximation of a constant quality factor Q, which has no attenuation effect on zero-frequency waves. Additionally, if you use C-PML absorbing layers in your simulations, which are implemented for the Newmark and LDDRK4-6 techniques but not for the classical RK4), the CFL upper limit decreases to approximately 95% of the limit without absorbing layers in the case of Newmark and to 85% in the case of LDDRK4-6.</p>

<table>
  <tbody>
    <tr>
      <td>Degree (N)</td>
      <td>Newmark</td>
      <td>LDDRK4-6</td>
      <td>RK4</td>
    </tr>
    <tr>
      <td>[0.5ex] 1</td>
      <td>0.709</td>
      <td>1.349</td>
      <td>1.003</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.577</td>
      <td>1.098</td>
      <td>0.816</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.593</td>
      <td>1.129</td>
      <td>0.839</td>
    </tr>
    <tr>
      <td><em>4</em></td>
      <td><em>0.604</em></td>
      <td><em>1.150</em></td>
      <td><em>0.854</em></td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.608</td>
      <td>1.157</td>
      <td>0.860</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.608</td>
      <td>1.157</td>
      <td>0.860</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.608</td>
      <td>1.157</td>
      <td>0.860</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.607</td>
      <td>1.155</td>
      <td>0.858</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.607</td>
      <td>1.155</td>
      <td>0.858</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.607</td>
      <td>1.155</td>
      <td>0.858</td>
    </tr>
    <tr>
      <td>[1ex]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>[table:CFLacoustic]</p>

<table>
  <tbody>
    <tr>
      <td>Degree (N)</td>
      <td>Newmark</td>
      <td>LDDRK4-6</td>
      <td>RK4</td>
    </tr>
    <tr>
      <td>[0.5ex] 1</td>
      <td>0.816</td>
      <td>1.553</td>
      <td>1.154</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.666</td>
      <td>1.268</td>
      <td>0.942</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.684</td>
      <td>1.302</td>
      <td>0.967</td>
    </tr>
    <tr>
      <td><em>4</em></td>
      <td><em>0.697</em></td>
      <td><em>1.327</em></td>
      <td><em>0.986</em></td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.700</td>
      <td>1.332</td>
      <td>0.990</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.700</td>
      <td>1.332</td>
      <td>0.990</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.700</td>
      <td>1.332</td>
      <td>0.990</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.699</td>
      <td>1.330</td>
      <td>0.989</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.698</td>
      <td>1.328</td>
      <td>0.987</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.698</td>
      <td>1.328</td>
      <td>0.987</td>
    </tr>
    <tr>
      <td>[1ex]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>[table:CFLelastic]</p>

<h2 id="how-to-set-plane-waves-as-initial-conditions">How to set plane waves as initial conditions</h2>

<p>To simulate propagation of incoming plane waves in the simulation domain, initial conditions based on analytical formulae of plane waves in homogeneous model need to be set. No additional body or boundary forces are required. To set up this scenario:</p>

<p><span><code class="highlighter-rouge">Par_file</code>:</span></p>

<ul>
  <li>
    <p>switch on <code class="highlighter-rouge">initialfield = .true. </code></p>
  </li>
  <li>
    <p>at this point setting <code class="highlighter-rouge">add_bielak_condition</code> does not seem to help with absorbing boundaries, therefore, it should be turned off.</p>
  </li>
</ul>

<p><span><code class="highlighter-rouge">SOURCE</code>:</span></p>

<ul>
  <li>
    <p><code class="highlighter-rouge">zs</code> has to be the same as the height of the simulation domain defined in <code class="highlighter-rouge">interfacesfile</code>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">xs</code> is the (x)-coordinate of the intersection of the initial plane wave front with the free surface.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">source_type</code> = 1 for a plane P wave, 2 for a plane SV wave, 3 for a Rayleigh wave.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">angleforce</code> can be negative to indicate a plane wave incident from the right (instead of the left)</p>
  </li>
</ul>

<h2 id="note-on-the-viscoelastic-model-used">Note on the viscoelastic model used</h2>

<p>The model used is a constant (Q), thus with no dependence on frequency ((Q(f)) = constant). See e.g. Blanc et al. (2016).</p>

<p>However in practice for technical reasons it is approximated based on the sum of different Generalized Zener body mechanisms and thus the code outputs the band in which the approximation is very good, outside of that range it can be less accurate. The logarithmic center of that frequency band is the <code class="highlighter-rouge">f0</code> parameter defined (in Hz) in input file <code class="highlighter-rouge">DATA/SOURCE</code>.</p>

<h2 id="note-on-viscoelasticity-in-the-2d-plane-strain-approximation">Note on viscoelasticity in the 2D plane strain approximation</h2>

<p>In 2D plane strain, one spatial dimension is much greater than the others (see for example: <a href="http://www.engineering.ucsb.edu/ hpscicom/projects/stress/introge.pdf">http://www.engineering.ucsb.edu/ hpscicom/projects/stress/introge.pdf</a>) and thus (\kappa = \lambda + \mu) in 2D plane strain (instead of (\kappa = \lambda + \frac{2}{3} \mu) in 3D). See for example J. M. Carcione, Kosloff, and Kosloff (1988b) equation (A9), and equation 6 in <a href="http://cherrypit.princeton.edu/papers/paper-99.pdf">http://cherrypit.princeton.edu/papers/paper-99.pdf</a>.</p>

<p>In 2D axisymmetric I think the 2/3 coefficient is OK, but it would be worth doublechecking.</p>

<h2 id="references">References</h2>

<p>Aki, K., and P. G. Richards. 1980. <em>Quantitative Seismology, Theory and Methods</em>. San Francisco, USA: W. H. Freeman.</p>

<p>Berg, P., F. If, P. Nielsen, and O. Skovegaard. 1994. “Analytic Reference Solutions.” In <em>Modeling the Earth for Oil Exploration, Final Report of the CEC’s GEOSCIENCE I Program 1990-1993</em>, edited by K. Helbig, 421–27. Pergamon Press, Oxford, United Kingdom.</p>

<p>Berland, J., C. Bogey, and C. Bailly. 2006. “Low-Dissipation and Low-Dispersion Fourth-Order Runge-Kutta Algorithm.” <em>Computers and Fluids</em> 35: 1459–63.</p>

<p>Blanc, Émilie, Dimitri Komatitsch, Emmanuel Chaljub, Bruno Lombard, and Zhinan Xie. 2016. “Highly Accurate Stability-Preserving Optimization of the Zener Viscoelastic Model, with Application to Wave Propagation in the Presence of Strong Attenuation.” <em>Geophys. J. Int.</em> 205 (1): 427–39. doi:<a href="http://dx.doi.org/10.1093/gji/ggw024">10.1093/gji/ggw024</a>.</p>

<p>Bottero, Alexis, Paul Cristini, Dimitri Komatitsch, and Mark Asch. 2016. “An Axisymmetric Time-Domain Spectral-Element Method for Full-Wave Simulations: Application to Ocean Acoustics.” <em>J. Acoust. Soc. Am.</em> 140 (5): 3520–30. doi:<a href="http://dx.doi.org/10.1121/1.4965964">10.1121/1.4965964</a>.</p>

<p>Carcione, J. M., D. Kosloff, and R. Kosloff. 1988a. “Wave Propagation Simulation in an Elastic Anisotropic (Transversely Isotropic) Solid.” <em>Q. J. Mech. Appl. Math.</em> 41 (3): 319–45.</p>

<p>———. 1988b. “Wave Propagation Simulation in a Linear Viscoelastic Medium.” <em>Geophys. J. Int.</em> 95: 597–611.</p>

<p>Carcione, José M. 2007. <em>Wave Fields in Real Media: Theory and Numerical Simulation of Wave Propagation in Anisotropic, Anelastic, Porous and Electromagnetic Media</em>. Second. Amsterdam, The Netherlands: Elsevier Science.</p>

<p><span>De Basabe</span>, Jon<span>á</span>s D., and Mrinal K. Sen. 2010. “Stability of the High-Order Finite Elements for Acoustic or Elastic Wave Propagation with High-Order Time Stepping.” <em>Geophys. J. Int.</em> 181 (1): 577–90. doi:<a href="http://dx.doi.org/10.1111/j.1365-246X.2010.04536.x">10.1111/j.1365-246X.2010.04536.x</a>.</p>

<p>Helbig, K. 1994. “Foundations of Anisotropy for Exploration Seismics.” In <em>Handbook of Geophysical Exploration, Section I: Seismic Exploration</em>, edited by K. Helbig and S. Treitel. Vol. 22. Oxford, England: Pergamon.</p>

<p>Helmberger, Donald V., and John E. Vidale. 1988. “Modeling Strong Motions Produced by Earthquakes with Two-Dimensional Numerical Codes.” <em>Bull. Seism. Soc. Am.</em> 78 (1): 109–21.</p>

<p>Komatitsch, D., and J. Tromp. 2002. “Spectral-Element Simulations of Global Seismic Wave Propagation-I. Validation.” <em>Geophys. J. Int.</em> 149 (2): 390–412. doi:<a href="http://dx.doi.org/10.1046/j.1365-246X.2002.01653.x">10.1046/j.1365-246X.2002.01653.x</a>.</p>

<p>Kristeková, Miriam, Jozef Kristek, and Peter Moczo. 2009. “Time-Frequency Misfit and Goodness-of-Fit Criteria for Quantitative Comparison of Time Signals.” <em>Geophys. J. Int.</em> 178 (2): 813–25. doi:<a href="http://dx.doi.org/10.1111/j.1365-246X.2009.04177.x">10.1111/j.1365-246X.2009.04177.x</a>.</p>

<p>Li, Dunzhu, Don Helmberger, Robert W. Clayton, and Daoyuan Sun. 2014. “Global Synthetic Seismograms Using a 2-D Finite-Difference Method.” <em>Geophys. J. Int.</em> 197 (2): 1166–83. doi:<a href="http://dx.doi.org/10.1093/gji/ggu050">10.1093/gji/ggu050</a>.</p>

<p>Morency, C., and J. Tromp. 2008. “Spectral-Element Simulations of Wave Propagation in Poroelastic Media.” <em>Geophys. J. Int.</em> 175: 301–45.</p>

<p>Pilant, Walter L. 1979. <em>Elastic Waves in the Earth</em>. Vol. 11 of Developments in Solid Earth Geophysics Series. Amsterdam, The Netherlands: Elsevier Scientific Publishing Company.</p>

<p>Schmidt, H. 2004. <em>OASES Version 3.1 User Guide and Reference Manual</em>. Center for Ocean Engineering, Massachusetts Institute of Technology, USA.</p>

<p>Tape, Carl, Qinya Liu, and Jeroen Tromp. 2007. “Finite-Frequency Tomography Using Adjoint Methods - Methodology and Examples Using Membrane Surface Waves.” <em>Geophys. J. Int.</em> 168 (3): 1105–29. doi:<a href="http://dx.doi.org/10.1111/j.1365-246X.2006.03191.x">10.1111/j.1365-246X.2006.03191.x</a>.</p>

<hr />
<blockquote>
  <p>This documentation has been automatically generated by <a href="http://www.pandoc.org">pandoc</a>
based on the User manual (LaTeX version) in folder doc/USER_MANUAL/
(Jul 26, 2018)</p>
</blockquote>


    </section>

    <section class="page-footer">
      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="http://github.com/danielpeter/specfem2d">specfem2d</a> is maintained by <a href="http://github.com/danielpeter">danielpeter</a></span>
        
        <span class="site-footer-credits">generated by <a href="https://pages.github.com">GitHub Pages</a></span>
      </footer>
    </section>

    
  </body>
</html>
